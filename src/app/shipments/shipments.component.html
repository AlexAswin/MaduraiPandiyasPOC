<app-nav-bar></app-nav-bar>

<app-side-off-canvas (messageEvent)="triggerSnackbar($event)"></app-side-off-canvas>

<div class="parent-container">
  <div class="container" [formGroup]="shipmentDetails">
    <h3>Materials Dispatch Form</h3>
    <div class="location-select-group">
      <div class="form-group mb-3">
        <label for="from">From:</label>
        <select id="from" class="form-control" formControlName="from">
          <option *ngFor="let loc of locations" [disabled]="shipmentDetails.get('to')?.value === loc" [value]="loc">
            {{ loc }}
          </option>
        </select>
      </div>

      <div class="form-group mb-3">
        <label for="to">To:</label>
        <select id="to" class="form-control" formControlName="to">
          <option *ngFor="let loc of locations" [disabled]="shipmentDetails.get('from')?.value === loc" [value]="loc">
            {{ loc }}
          </option>
        </select>
      </div>
    </div>


    <div class="form-group d-flex">
      <div class="form-group selectItemcontainer">
        <select id="selectItem" class="form-control" style="min-width: 100px;" placeholder="SelectItem"
          formControlName="message">
          <option value="" disabled selected>Select Item</option>

          <option *ngFor="let item of Items" [value]="item">
            {{ item }}
          </option>
        </select>
      </div>


      <input type="number" class="form-control" placeholder="Enter quantity" formControlName="quantity" min="1">

      <div class="form-group d-flex">
        <select id="unit" class="form-control" style="min-width: 100px;" placeholder="Units" formControlName="unit">
          <option value="" disabled selected>Units</option>
          <option *ngFor="let unit of units" [value]="unit">
            {{ unit }}
          </option>
        </select>
      </div>

      <button type="button" class="btn btn-success" (click)="addItem()">Add Item</button>
    </div>

    <div *ngIf="items.length > 0" class="mt-3 items-container">
      <label>Items</label>
      <ul class="list-group">
        <li *ngFor="let item of items.controls; let i = index"
          class="list-group-item d-flex justify-content-between align-items-center">
          {{ item.value.name }} - {{ item.value.quantity }}{{item.value.unit}}
          <button type="button" class="btn btn-sm btn-danger" (click)="removeItem(i)"><i
              class="bi bi-x-lg"></i></button>
        </li>
      </ul>
    </div>

    <div class="button-container">
      <button class="btn btn-primary" [disabled]="shipmentDetails.invalid || items.length === 0"
        (click)="onSubmit()">Confirm Dispatch</button>

      <button class="dispatch-Details" [routerLink]="['/dispatch-details']">Dispatch Details</button>
    </div>
  </div>
</div>

<div class="snackbar" [class.show]="showSnackbar">
  {{ ShowMessage }}
</div>