import{$a as c,Ta as P,Va as h,Wa as q,Xa as v,Ya as E,Za as r,_a as y,bb as d,d as g,db as l,eb as S,fb as f,gb as u,v as w,y as b}from"./chunk-I7XMEI44.js";import{a as R,e as m}from"./chunk-5FZOKLP6.js";var G=(()=>{class a{constructor(e){this.firestore=e,this.shipments$=new g([]),this.shipmentsObservable=this.shipments$.asObservable()}submitShipment(e,t){return m(this,null,function*(){try{let s=r(this.firestore,t),o=e.DispatchedDate,i=l(s,u("DispatchedDate","==",o)),n=yield d(i);if(!n.empty){let p=n.docs[0],I=p.data(),F=[...I.shipmentItemsDetails,...e.shipmentItemsDetails];return yield f(p.ref,{shipmentItemsDetails:F,shipmentGrandTotal:I.shipmentGrandTotal+e.shipmentGrandTotal}),p.id}return(yield q(s,R({},e))).id}catch(s){throw console.error("Error adding shipment:",s),s}})}getAllShipmentDetails(e){let t=e==="Madurai Pandiyas"?"Madurai Pandiyas":"Madurai Pandiyas Elite",s=r(this.firestore,t);return h(s,{idField:"id"})}setShipments(e){this.shipments$.next([...e])}getShipments(){return[...this.shipments$.value]}getAllItemsDetails(e){let t=r(this.firestore,e);return h(t,{idField:"id"})}deleteShipmentById(e,t){let s=c(this.firestore,e,t);return y(s)}updateItemPrice(e,t){let s=r(this.firestore,"Items"),o=l(s,u("itemName","==",e));d(o).then(i=>{i.empty||i.forEach(n=>m(this,null,function*(){let D=c(this.firestore,"Items",n.id);yield f(D,{unitPrice:t})}))}).catch(i=>{console.error("Error updating item price:",i)})}deleteItem(e){return m(this,null,function*(){try{let t=r(this.firestore,"Items"),s=l(t,u("itemName","==",e)),o=yield d(s);o.empty?console.log("No item found with that name."):o.forEach(i=>m(this,null,function*(){let n=c(this.firestore,"Items",i.id);yield y(n),console.log(`Deleted item: ${e}`)}))}catch(t){console.error("Error deleting item:",t)}})}submitItemRequest(e,t){let s=c(this.firestore,"Purchase List",t);return S(s,{items:E(...e.items),RequestedOn:e.RequestedOn},{merge:!0})}getPurchaseItems(e){let t=r(this.firestore,e);return h(t,{idField:"id"})}deletePurchasedItems(e,t){let s=c(this.firestore,"Purchase List",e);return f(s,{items:v(...t)})}static{this.\u0275fac=function(t){return new(t||a)(b(P))}}static{this.\u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{G as a};
