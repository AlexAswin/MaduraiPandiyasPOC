import{$a as c,Ta as q,Va as m,Wa as E,Xa as F,Ya as b,Za as o,_a as D,bb as l,db as f,eb as S,fb as h,gb as u,w,z as P}from"./chunk-EFXSARBN.js";import{a as R,b as g,e as d}from"./chunk-5FZOKLP6.js";var G=(()=>{class a{constructor(e){this.firestore=e}submitShipment(e,t){return d(this,null,function*(){try{let r=o(this.firestore,t),s=new Date(e.DispatchedTime).toDateString(),i=f(r,u("DispatchedDate","==",s)),n=yield l(i);if(!n.empty){let p=n.docs[0],I=p.data(),T=[...I.shipmentItemsDetails,...e.shipmentItemsDetails];return yield h(p.ref,{shipmentItemsDetails:T,shipmentGrandTotal:I.shipmentGrandTotal+e.shipmentGrandTotal}),p.id}return(yield E(r,g(R({},e),{DispatchedDate:s}))).id}catch(r){throw console.error("Error adding shipment:",r),r}})}getAllShipmentDetails(e){let t=e==="Madurai Pandiyas"?"Madurai Pandiyas":"Madurai Pandiyas Elite",r=o(this.firestore,t);return m(r,{idField:"id"})}getAllItemsDetails(e){let t=o(this.firestore,e);return m(t,{idField:"id"})}deleteShipmentById(e,t){let r=c(this.firestore,e,t);return D(r)}updateItemPrice(e,t){let r=o(this.firestore,"Items"),s=f(r,u("itemName","==",e));l(s).then(i=>{i.empty||i.forEach(n=>d(this,null,function*(){let y=c(this.firestore,"Items",n.id);yield h(y,{unitPrice:t})}))}).catch(i=>{console.error("Error updating item price:",i)})}deleteItem(e){return d(this,null,function*(){try{let t=o(this.firestore,"Items"),r=f(t,u("itemName","==",e)),s=yield l(r);s.empty?console.log("No item found with that name."):s.forEach(i=>d(this,null,function*(){let n=c(this.firestore,"Items",i.id);yield D(n),console.log(`Deleted item: ${e}`)}))}catch(t){console.error("Error deleting item:",t)}})}submitItemRequest(e,t){let r=c(this.firestore,"Purchase List",t);return S(r,{items:b(...e.items),RequestedOn:e.RequestedOn},{merge:!0})}getPurchaseItems(e){let t=o(this.firestore,e);return m(t,{idField:"id"})}deletePurchasedItems(e,t){let r=c(this.firestore,"Purchase List",e);return h(r,{items:F(...t)})}static{this.\u0275fac=function(t){return new(t||a)(P(q))}}static{this.\u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{G as a};
