import"./chunk-F7CRVBCT.js";import{a as W}from"./chunk-4ZGI2PAT.js";import{a as q,b as _,c as j,d as J,h as z,i as L,j as G,k as K,l as Q,m as R,n as X,o as $}from"./chunk-LYFLVW55.js";import{a as Y}from"./chunk-I5J7QDJK.js";import{B as g,D as l,E as F,F as o,G as i,H as f,I as D,J as d,K as h,M as a,O as C,Q as I,S as E,T as k,Z as B,_ as A,aa as N,fa as T,ga as V,ia as H,m as v,q as y,r as U,s as w,t as S,x as s,y as M}from"./chunk-4UYCYSSX.js";import{e as P}from"./chunk-5FZOKLP6.js";var et=()=>["/dispatch-details"];function nt(r,p){if(r&1&&(o(0,"option",26),a(1),i()),r&2){let t,e=p.$implicit,n=h();l("disabled",((t=n.shipmentDetails.get("to"))==null?null:t.value)===e)("value",e),s(),C(" ",e," ")}}function ot(r,p){if(r&1&&(o(0,"option",26),a(1),i()),r&2){let t,e=p.$implicit,n=h();l("disabled",((t=n.shipmentDetails.get("from"))==null?null:t.value)===e)("value",e),s(),C(" ",e," ")}}function it(r,p){if(r&1&&(o(0,"option",27),a(1),i()),r&2){let t=p.$implicit;l("value",t),s(),C(" ",t," ")}}function rt(r,p){if(r&1&&(o(0,"option",27),a(1),i()),r&2){let t=p.$implicit;l("value",t),s(),C(" ",t," ")}}function at(r,p){if(r&1){let t=D();o(0,"li",31),a(1),o(2,"button",32),d("click",function(){let n=y(t).index,c=h(2);return U(c.removeItem(n))}),f(3,"i",33),i()()}if(r&2){let t=p.$implicit;s(),I(" ",t.value.name," - ",t.value.quantity,"",t.value.unit," ")}}function st(r,p){if(r&1&&(o(0,"div",28)(1,"label"),a(2,"Items"),i(),o(3,"ul",29),g(4,at,4,3,"li",30),i()()),r&2){let t=h();s(4),l("ngForOf",t.items.controls)}}var Mt=(()=>{class r{constructor(t,e,n){this.fb=t,this.shipmentService=e,this.router=n,this.locations=["Madurai Pandiyas","Madurai Pandiyas Elite"],this.Items=[],this.units=["Kg","Ltr","Nos"],this.ItemsInformation=[],this.showSnackbar=!1,this.fromAndToValue=()=>{localStorage.getItem("UserId")==="Madurai Pandiyas"?(this.shipmentDetails.get("from")?.setValue("Madurai Pandiyas"),this.shipmentDetails.get("to")?.setValue("Madurai Pandiyas Elite")):(this.shipmentDetails.get("from")?.setValue("Madurai Pandiyas Elite"),this.shipmentDetails.get("to")?.setValue("Madurai Pandiyas"))},this.logOutUser=()=>{localStorage.removeItem("UserId"),this.router.navigate(["/"])},this.getItems(),this.shipmentDetails=this.fb.group({from:["",_.required],to:["",_.required],message:[""],quantity:[[""],[_.min(1)]],unit:[""],items:this.fb.array([],_.required)}),this.shipmentDetails.get("from")?.valueChanges.subscribe(c=>{let u=this.shipmentDetails.get("to");u?.value===c&&u?.setValue("",{emitEvent:!1})}),this.shipmentDetails.get("to")?.valueChanges.subscribe(c=>{let u=this.shipmentDetails.get("from");u?.value===c&&u?.setValue("",{emitEvent:!1})}),this.fromAndToValue()}getItems(){this.shipmentService.getAllItemsDetails("Items").subscribe(t=>{this.ItemsInformation=t.map(e=>({itemName:e.itemName,unitPrice:Number(e.unitPrice)})),this.Items=t.map(e=>e.itemName)})}get items(){return this.shipmentDetails.get("items")}addItem(){let t=this.shipmentDetails.get("message")?.value?.trim(),e=this.shipmentDetails.get("quantity")?.value.trim(),n=this.shipmentDetails.get("unit")?.value.trim();t&&e&&n&&this.items.push(this.fb.group({name:[t],quantity:[e],unit:[n]})),this.shipmentDetails.get("message")?.setValue(""),this.shipmentDetails.get("quantity")?.reset(),this.shipmentDetails.get("unit")?.setValue("")}removeItem(t){this.items.removeAt(t)}showMessage(){this.showSnackbar=!0,setTimeout(()=>this.showSnackbar=!1,3e3)}onSubmit(){return P(this,null,function*(){if(!this.shipmentDetails.invalid)try{let t=new Date().toLocaleString(),e=this.shipmentDetails.get("from")?.value?.trim(),n=this.shipmentDetails.get("to")?.value?.trim(),c=new Map(this.ItemsInformation.map(m=>[m.itemName,m.unitPrice])),x=this.shipmentDetails.get("items").value;console.log(x);let O=x.filter(m=>c.has(m.name)).map(m=>({itemName:m.name,quantity:m.quantity,unit:m.unit,unitPrice:c.get(m.name),totalPrice:m.quantity*c.get(m.name)}));console.log(O);let Z=O.reduce((m,tt)=>m+tt.totalPrice,0),b={shipmentItemsDetails:O,DispatchedTime:t,shipmentGrandTotal:Z,shipmentFrom:e,shipmentTo:n};console.log(b),yield this.shipmentService.submitShipment(b,e),this.showMessage(),this.items.clear()}catch(t){console.error("Error submitting shipment:",t),alert("Error submitting shipment. Check console for details.")}})}static{this.\u0275fac=function(e){return new(e||r)(M(R),M(Y),M(T))}}static{this.\u0275cmp=v({type:r,selectors:[["app-shipments"]],standalone:!0,features:[E],decls:44,vars:11,consts:[[1,"parent-container"],[1,"container",3,"formGroup"],[1,"location-select-group"],[1,"form-group","mb-3"],["for","from"],["id","from","formControlName","from",1,"form-control"],[3,"disabled","value",4,"ngFor","ngForOf"],["for","to"],["id","to","formControlName","to",1,"form-control"],[1,"form-group","d-flex"],[1,"form-group"],["id","selectItem","placeholder","SelectItem","formControlName","message",1,"form-control",2,"min-width","100px"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Enter quantity","formControlName","quantity","min","1",1,"form-control"],["id","unit","placeholder","Units","formControlName","unit",1,"form-control",2,"min-width","100px"],["type","button",1,"btn","btn-success",3,"click"],["class","mt-3 items-container",4,"ngIf"],[1,"button-container"],[1,"btn","btn-primary",3,"click","disabled"],[1,"dispatch-Details",3,"routerLink"],[1,"snackbar"],[1,"logoutBtnContainer"],[1,"logOutBtn",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","26","height","26","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-arrow-left-circle"],["fill-rule","evenodd","d","M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5z"],[3,"disabled","value"],[3,"value"],[1,"mt-3","items-container"],[1,"list-group"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[1,"bi","bi-x-lg"]],template:function(e,n){e&1&&(f(0,"app-nav-bar"),o(1,"div",0)(2,"div",1)(3,"h3"),a(4,"Materials Dispatch Form"),i(),o(5,"div",2)(6,"div",3)(7,"label",4),a(8,"From:"),i(),o(9,"select",5),g(10,nt,2,3,"option",6),i()(),o(11,"div",3)(12,"label",7),a(13,"To:"),i(),o(14,"select",8),g(15,ot,2,3,"option",6),i()()(),o(16,"div",9)(17,"div",10)(18,"select",11)(19,"option",12),a(20,"Select Item"),i(),g(21,it,2,2,"option",13),i()(),f(22,"input",14),o(23,"div",9)(24,"select",15)(25,"option",12),a(26,"Units"),i(),g(27,rt,2,2,"option",13),i()(),o(28,"button",16),d("click",function(){return n.addItem()}),a(29,"Add Item"),i()(),g(30,st,5,1,"div",17),o(31,"div",18)(32,"button",19),d("click",function(){return n.onSubmit()}),a(33,"Confirm Dispatch"),i(),o(34,"button",20),a(35,"Dispatch Details"),i()()()(),o(36,"div",21),a(37,` Materials Dispatched!
`),i(),o(38,"div",22)(39,"button",23),d("click",function(){return n.logOutUser()}),w(),o(40,"svg",24),f(41,"path",25),i(),S(),o(42,"span"),a(43,"LogOut"),i()()()),e&2&&(s(2),l("formGroup",n.shipmentDetails),s(8),l("ngForOf",n.locations),s(5),l("ngForOf",n.locations),s(6),l("ngForOf",n.Items),s(6),l("ngForOf",n.units),s(3),l("ngIf",n.items.length>0),s(2),l("disabled",n.shipmentDetails.invalid||n.items.length===0),s(2),l("routerLink",k(10,et)),s(2),F("show",n.showSnackbar))},dependencies:[$,K,Q,q,G,j,J,z,L,N,B,A,X,W,H,V],styles:['@font-face{font-family:Montserrat;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/montserrat/v31/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Hw0aXpsog.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Montserrat;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/montserrat/v31/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Hw9aXpsog.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Montserrat;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/montserrat/v31/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Hw2aXpsog.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:Montserrat;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/montserrat/v31/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Hw3aXpsog.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Montserrat;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/montserrat/v31/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Hw5aXo.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}body[_ngcontent-%COMP%]{background:#d2d2d2}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:800px;width:90%;background:#fff;border-radius:12px;padding:40px;box-shadow:0 6px 20px #0000001a;font-family:Montserrat,sans-serif;transition:all .3s ease;z-index:1000;min-height:40vh;overflow-y:auto;margin-top:75px}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;font-size:1.8rem;text-align:center;color:#333;margin-bottom:2rem}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .location-select-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap;gap:20px;margin-bottom:1.5rem}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .location-select-group[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;min-width:45%}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .location-select-group[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;color:#555;margin-bottom:5px}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .location-select-group[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:100%;border-radius:8px;border:1px solid #ccc;padding:8px 12px;font-size:15px;transition:border-color .3s ease}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .location-select-group[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#007bff;box-shadow:0 0 4px #007bff40}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .location-select-group[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form-group.d-flex[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form-group.d-flex[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border-radius:8px;border:1px solid #ccc;padding:8px 12px;font-size:15px}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form-group.d-flex[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#28a745;box-shadow:0 0 4px #28a74540}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form-group.d-flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:8px;padding:8px 16px;transition:background-color .3s ease}.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .form-group.d-flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#218838}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:nowrap;padding:15px 0}.dispatch-Details[_ngcontent-%COMP%]{background:none;border:none;color:#007bff;font-size:16px;font-family:Montserrat,sans-serif;cursor:pointer;padding:8px 12px;transition:color .3s ease}.dispatch-Details[_ngcontent-%COMP%]:hover{color:#0056b3}.snackbar[_ngcontent-%COMP%]{visibility:hidden;min-width:250px;background-color:#28a745;color:#fff;text-align:center;border-radius:8px;padding:12px;position:fixed;bottom:30px;left:50%;transform:translate(-50%);z-index:1000;opacity:0;transition:opacity .3s,visibility .3s}.snackbar.show[_ngcontent-%COMP%]{visibility:visible;opacity:1}.logoutBtnContainer[_ngcontent-%COMP%]{width:100%}.logOutBtn[_ngcontent-%COMP%]{cursor:pointer;font-weight:700;transition:all .2s;padding:10px 20px;border-radius:100px;background:#000;border:1px solid transparent;display:flex;align-items:center;font-size:15px;color:#fff;margin-right:100px;bottom:0;position:absolute;right:0;margin-bottom:100px}.logOutBtn[_ngcontent-%COMP%]:hover{background:#000}.logOutBtn[_ngcontent-%COMP%] > svg[_ngcontent-%COMP%]{width:34px;margin-right:5px;transition:transform .3s ease-in-out}.logOutBtn[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{transform:translate(-10px)}.logOutBtn[_ngcontent-%COMP%]:active{transform:scale(.95)}@media (max-width: 576px){.parent-container[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{width:95%;padding:10px}.parent-container[_ngcontent-%COMP%]   .location-select-group[_ngcontent-%COMP%]{flex-direction:column}.parent-container[_ngcontent-%COMP%]   .location-select-group[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;min-width:100%;flex-direction:column}.parent-container[_ngcontent-%COMP%]   .form-group.d-flex[_ngcontent-%COMP%]{flex-direction:column}.parent-container[_ngcontent-%COMP%]   .form-group.d-flex[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{min-width:100%}.parent-container[_ngcontent-%COMP%]   .form-group.d-flex[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:0}.parent-container[_ngcontent-%COMP%]   .form-group.d-flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100%}.logoutBtnContainer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.logoutBtnContainer[_ngcontent-%COMP%]   .logOutBtn[_ngcontent-%COMP%]{position:static;margin:40px auto}}']})}}return r})();export{Mt as ShipmentsComponent};
